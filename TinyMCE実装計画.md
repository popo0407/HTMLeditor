# TinyMCE 実装計画

## プロジェクト概要

Microsoft Word ライクなリッチテキストエディタを TinyMCE を使用して実装する。
既存の Quill.js ベースのエディタから段階的に移行する。

## 実装進捗状況

### ✅ 完了済み

1. **TinyMCE 基本セットアップ**

   - `@tinymce/tinymce-react`と`tinymce`パッケージのインストール
   - 基本的な TinyMCE エディタコンポーネントの実装
   - API キーの設定（環境変数 + フォールバック）
   - エディタの表示確認

2. **プロジェクト構造**

   - `frontend/src/tinymceEditor/`ディレクトリの作成
   - コンポーネント、設定、サービス、スタイル、型定義の分離

3. **基本設定**
   - TinyMCE 設定ファイル（`tinymce-config.ts`）の実装
   - 基本的なプラグインとツールバーの設定
   - API キーの環境変数対応

### 🔄 現在の状況

- **エディタ表示**: ✅ 完了
- **基本編集機能**: 🔄 確認中
- **HTML インポート/エクスポート**: ❌ 未実装
- **テーブル操作**: ❌ 未実装
- **カスタム機能**: ❌ 未実装

### 📋 次の実装タスク

#### Phase 1: 基本機能の動作確認

1. **エディタの基本動作確認**

   - テキスト入力・編集
   - フォーマット（太字、斜体、下線）
   - 見出し、リスト
   - リンク、画像挿入
   - テーブル作成・編集

2. **HTML インポート/エクスポート機能**

   - ファイルからの HTML 読み込み
   - エディタ内容の HTML エクスポート
   - ドラッグ&ドロップ対応
   - クリップボード操作

3. **テーブル操作機能**
   - テーブルの挿入・削除
   - 行・列の追加・削除
   - セルの結合・分割
   - テーブルスタイルの適用

#### Phase 2: カスタム機能の実装

1. **カスタムボタン**

   - 見出しボタン（H1, H2）
   - 重要・アクションアイテムボタン
   - カスタムスタイルの適用

2. **キーボードショートカット**

   - 太字（Ctrl+B）
   - 下線（Ctrl+U）
   - 見出し（Ctrl+Shift+H）

3. **コンテキストメニュー**
   - 右クリックメニューのカスタマイズ
   - よく使う機能へのクイックアクセス

#### Phase 3: 高度な機能

1. **ファイル操作パネル**

   - ファイルアップロード
   - エクスポートオプション
   - プレビュー機能

2. **テーブル操作パネル**

   - テーブルテンプレート
   - 高度なテーブル編集機能

3. **マークダウン対応**
   - マークダウンテキストのインポート
   - HTML からマークダウンへの変換

## 技術仕様

### 使用技術

- **React 18**
- **TypeScript**
- **TinyMCE 6.8.0**
- **@tinymce/tinymce-react 4.3.0**

### ファイル構造

```
frontend/src/tinymceEditor/
├── components/
│   ├── TinyMCEEditor.tsx ✅
│   ├── FileOperations.tsx ❌
│   └── TableOperations.tsx ❌
├── config/
│   └── tinymce-config.ts ✅
├── services/
│   ├── htmlImportService.ts ❌
│   ├── htmlExportService.ts ❌
│   └── tableService.ts ❌
├── styles/
│   └── TinyMCEEditor.css ❌
└── types/
    └── tinymceTypes.ts ✅
```

### 環境変数設定

```env
REACT_APP_TINYMCE_APIKEY=your_api_key_here
```

## 移行戦略

### Quill.js からの移行

1. **段階的移行**: 既存の Quill.js エディタと並行運用
2. **データ互換性**: 既存の HTML データとの互換性確保
3. **機能対比**: 既存機能の同等実装
4. **最終削除**: 移行完了後の Quill.js 関連ファイル削除

## 成功指標

- [ ] エディタの基本動作確認完了
- [ ] HTML インポート/エクスポート機能実装
- [ ] テーブル操作機能実装
- [ ] カスタム機能実装
- [ ] 既存 Quill.js エディタとの機能同等性確認
- [ ] パフォーマンステスト完了

## リスク管理

- **API キー管理**: 環境変数での安全な管理
- **ブラウザ互換性**: 主要ブラウザでの動作確認
- **パフォーマンス**: 大容量 HTML の処理性能
- **セキュリティ**: XSS 対策と HTML サニタイゼーション

## 完了基準

1. すべての基本機能が正常に動作
2. HTML インポート/エクスポートが完璧に機能
3. テーブル操作が直感的に使用可能
4. カスタム機能が期待通りに動作
5. 既存システムとの統合が完了

## 次のアクション

1. **基本動作確認**: エディタの各機能をテスト
2. **HTML インポート/エクスポート実装**: ファイル操作機能の実装
3. **テーブル操作実装**: テーブル関連機能の実装
4. **カスタム機能実装**: 独自のボタンとショートカットの実装
