### 4\. 段階的な実装計画

開発をスムーズに進めるため、以下の4フェーズに分けた段階的な実装計画を提案します。

#### **フェーズ1: 基盤構築とコアAPIの実装**

  * **目標**: バックエンドの基盤を固め、アドレス帳の基本的な管理ができるようにする。
  * **タスク**:
    1.  **共通**: Gitリポジトリ作成、開発環境構築。
    2.  **バックエンド**: FastAPIプロジェクトのセットアップ。SQLAlchemyを導入し、DBモデル（CommonID, Contact）を定義。アドレス帳と連絡先のCRUD API (`/api/address-books/...`) を実装。
    3.  **フロントエンド**: Reactプロジェクトのセットアップ（`create-react-app`等）。基本的な画面レイアウト（ヘッダー、サイドバー、メインエリア）をコンポーネントとして作成。
    4.  **結合**: フロントエンドからアドレス帳取得APIを呼び出し、ダミーデータを表示できることを確認。

#### **フェーズ2: ブロックエディタの基本機能実装**

  * **目標**: テキストベースのコンテンツを読み込み、編集・追加・削除ができるようにする。
  * **タスク**:
    1.  **フロントエンド**:
          * コンテンツのstateデータ構造（JSON配列）を定義。
          * テキスト系ブロック（見出し、箇条書き）のReactコンポーネントを作成。
          * クリップボードからのHTML読み込み (`F-001-1`) とJSONへの変換ロジックを実装。
          * ブロックの追加 (`F-001-2`)、編集 (`F-001-4`)、削除 (`F-001-6`) 機能を実装。
          * 編集内容からHTMLをダウンロードする機能 (`F-003-1`) を実装。

#### **フェーズ3: エディタの拡張機能とメール連携**

  * **目標**: エディタを完成させ、メール送信機能と連携させる。
  * **タスク**:
    1.  **フロントエンド**:
          * 画像、テーブル、水平線ブロックのコンポーネントを実装。
          * 画像アップロードとクリップボードからの貼り付け機能 (`F-002`) を実装。
          * ドラッグ＆ドロップによるブロック並び替え (`F-001-7`) を実装。
          * メール送信のためのUI（共通ID入力、宛先選択、連絡先追加）を実装。
    2.  **バックエンド**: メール送信API (`/api/send-mail`) と、`smtplib` を使った送信ロジックを実装。
    3.  **結合**: フロントエンドからメール送信APIを呼び出し、編集したHTMLが添付されたメールが実際に送信されることを確認。

#### **フェーズ4: 仕上げとリリース準備**

  * **目標**: 全ての機能を完成させ、品質を高めてリリースできる状態にする。
  * **タスク**:
    1.  **フロントエンド**:
          * プレビュー画面 (`F-007-2`) を実装。
          * PDF出力機能 (`F-003-2`, `window.print()`) を実装。
          * 指定されたCSSを適用し、全体のデザイントーンを統一 (`NF-003`)。
          * エラーメッセージや操作フィードバックなど、UI/UXの最終調整。
    2.  **共通**: 全体を通したテストとバグ修正。IISへのデプロイ手順を確立し、テストデプロイを実施。
